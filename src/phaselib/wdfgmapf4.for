C Datei: USERDISK_3:[FLECHSIG.PHNEU]WDFGMAPF4.FOR
C Datum: 12.APR.1996
C Stand: 12-APR-1996
C Autor: FLECHSIG, BESSY Berlin               

c ******************************************************************************
c
c   Copyright (C) 2014 Helmholtz-Zentrum Berlin, Germany and 
c                      Paul Scherrer Institut Villigen, Switzerland
c   
c   Author Johannes Bahrdt, johannes.bahrdt@helmholtz-berlin.de
c          Uwe Flechsig,    uwe.flechsig@psi.ch
c
c ------------------------------------------------------------------------------
c
c   This file is part of PHASE.
c
c   PHASE is free software: you can redistribute it and/or modify
c   it under the terms of the GNU General Public License as published by
c   the Free Software Foundation, version 3 of the License, or
c   (at your option) any later version.
c
c   PHASE is distributed in the hope that it will be useful,
c   but WITHOUT ANY WARRANTY; without even the implied warranty of
c   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
c   GNU General Public License for more details.
c
c   You should have received a copy of the GNU General Public License
c   along with PHASE (src/LICENSE).  If not, see <http://www.gnu.org/licenses/>. 
c
c ******************************************************************************


      subroutine subf(a,
     &		      sina,cosa,sinb,cosb,r,rp,idefl,
     &                dq7,dq8,dq9,dqa,dqb,dqc,dqd,dqe)
      implicit real*8(a-h,o-z)

c      common/mirror/
      dimension	a(0:5,0:5)
c      common/map4/
       dimension    dq7(0:4,0:4,0:4,0:4),
     &              dq8(0:4,0:4,0:4,0:4),
     &              dq9(0:4,0:4,0:4,0:4),
     &              dqa(0:4,0:4,0:4,0:4),
     &              dqb(0:4,0:4,0:4,0:4),
     &              dqc(0:4,0:4,0:4,0:4),
     &              dqd(0:4,0:4,0:4,0:4),
     &              dqe(0:4,0:4,0:4,0:4)
                                              
      xdefl=dflotj(idefl)


c      IDEFL=XDEFL        ??

      DQ7(0.,0.,0.,0.)=-A(0.,0.)*XDEFL*SINA
      DQ8(0.,0.,0.,0.)=-A(0.,0.)*COSA+R
      DQ9(0.,0.,0.,0.)=0.
      DQA(0.,0.,0.,0.)=-A(0.,0.)*COSA+R
      DQB(0.,0.,0.,0.)=-A(0.,0.)*XDEFL*SINB
      DQC(0.,0.,0.,0.)=-A(0.,0.)*COSB+RP
      DQD(0.,0.,0.,0.)=0.
      DQE(0.,0.,0.,0.)=-A(0.,0.)*COSB+RP
      DQ7(0.,0.,0.,1.)=0.
      DQ8(0.,0.,0.,1.)=0.
      DQ9(0.,0.,0.,1.)=(-1.)
      DQA(0.,0.,0.,1.)=0.
      DQB(0.,0.,0.,1.)=0.
      DQC(0.,0.,0.,1.)=0.
      DQD(0.,0.,0.,1.)=1.
      DQE(0.,0.,0.,1.)=0.
      DQ7(0.,0.,0.,2.)=0.
      DQ8(0.,0.,0.,2.)=0.
      DQ9(0.,0.,0.,2.)=0.
      DQA(0.,0.,0.,2.)=0.
      DQB(0.,0.,0.,2.)=0.
      DQC(0.,0.,0.,2.)=0.
      DQD(0.,0.,0.,2.)=0.
      DQE(0.,0.,0.,2.)=0.
      DQ7(0.,0.,0.,3.)=0.
      DQ8(0.,0.,0.,3.)=0.
      DQ9(0.,0.,0.,3.)=0.
      DQA(0.,0.,0.,3.)=0.
      DQB(0.,0.,0.,3.)=0.
      DQC(0.,0.,0.,3.)=0.
      DQD(0.,0.,0.,3.)=0.
      DQE(0.,0.,0.,3.)=0.
      DQ7(0.,0.,0.,4.)=0.
      DQ8(0.,0.,0.,4.)=0.
      DQ9(0.,0.,0.,4.)=0.
      DQA(0.,0.,0.,4.)=0.
      DQB(0.,0.,0.,4.)=0.
      DQC(0.,0.,0.,4.)=0.
      DQD(0.,0.,0.,4.)=0.
      DQE(0.,0.,0.,4.)=0.
      DQ7(0.,0.,1.,0.)=(-1.)
      DQ8(0.,0.,1.,0.)=0.
      DQ9(0.,0.,1.,0.)=0.
      DQA(0.,0.,1.,0.)=0.
      DQB(0.,0.,1.,0.)=1.
      DQC(0.,0.,1.,0.)=0.
      DQD(0.,0.,1.,0.)=0.
      DQE(0.,0.,1.,0.)=0.
      DQ7(0.,0.,1.,1.)=0.
      DQ8(0.,0.,1.,1.)=0.
      DQ9(0.,0.,1.,1.)=0.
      DQA(0.,0.,1.,1.)=0.
      DQB(0.,0.,1.,1.)=0.
      DQC(0.,0.,1.,1.)=0.
      DQD(0.,0.,1.,1.)=0.
      DQE(0.,0.,1.,1.)=0.
      DQ7(0.,0.,1.,2.)=0.
      DQ8(0.,0.,1.,2.)=0.
      DQ9(0.,0.,1.,2.)=0.
      DQA(0.,0.,1.,2.)=0.
      DQB(0.,0.,1.,2.)=0.
      DQC(0.,0.,1.,2.)=0.
      DQD(0.,0.,1.,2.)=0.
      DQE(0.,0.,1.,2.)=0.
      DQ7(0.,0.,1.,3.)=0.
      DQ8(0.,0.,1.,3.)=0.
      DQ9(0.,0.,1.,3.)=0.
      DQA(0.,0.,1.,3.)=0.
      DQB(0.,0.,1.,3.)=0.
      DQC(0.,0.,1.,3.)=0.
      DQD(0.,0.,1.,3.)=0.
      DQE(0.,0.,1.,3.)=0.
      DQ7(0.,0.,2.,0.)=0.
      DQ8(0.,0.,2.,0.)=0.
      DQ9(0.,0.,2.,0.)=0.
      DQA(0.,0.,2.,0.)=0.
      DQB(0.,0.,2.,0.)=0.
      DQC(0.,0.,2.,0.)=0.
      DQD(0.,0.,2.,0.)=0.
      DQE(0.,0.,2.,0.)=0.
      DQ7(0.,0.,2.,1.)=0.
      DQ8(0.,0.,2.,1.)=0.
      DQ9(0.,0.,2.,1.)=0.
      DQA(0.,0.,2.,1.)=0.
      DQB(0.,0.,2.,1.)=0.
      DQC(0.,0.,2.,1.)=0.
      DQD(0.,0.,2.,1.)=0.
      DQE(0.,0.,2.,1.)=0.
      DQ7(0.,0.,2.,2.)=0.
      DQ8(0.,0.,2.,2.)=0.
      DQ9(0.,0.,2.,2.)=0.
      DQA(0.,0.,2.,2.)=0.
      DQB(0.,0.,2.,2.)=0.
      DQC(0.,0.,2.,2.)=0.
      DQD(0.,0.,2.,2.)=0.
      DQE(0.,0.,2.,2.)=0.
      DQ7(0.,0.,3.,0.)=0.
      DQ8(0.,0.,3.,0.)=0.
      DQ9(0.,0.,3.,0.)=0.
      DQA(0.,0.,3.,0.)=0.
      DQB(0.,0.,3.,0.)=0.
      DQC(0.,0.,3.,0.)=0.
      DQD(0.,0.,3.,0.)=0.
      DQE(0.,0.,3.,0.)=0.
      DQ7(0.,0.,3.,1.)=0.
      DQ8(0.,0.,3.,1.)=0.
      DQ9(0.,0.,3.,1.)=0.
      DQA(0.,0.,3.,1.)=0.
      DQB(0.,0.,3.,1.)=0.
      DQC(0.,0.,3.,1.)=0.
      DQD(0.,0.,3.,1.)=0.
      DQE(0.,0.,3.,1.)=0.
      DQ7(0.,0.,4.,0.)=0.
      DQ8(0.,0.,4.,0.)=0.
      DQ9(0.,0.,4.,0.)=0.
      DQA(0.,0.,4.,0.)=0.
      DQB(0.,0.,4.,0.)=0.
      DQC(0.,0.,4.,0.)=0.
      DQD(0.,0.,4.,0.)=0.
      DQE(0.,0.,4.,0.)=0.
      DQ7(0.,1.,0.,0.)=-A(0.,1.)*XDEFL*SINA
      DQ8(0.,1.,0.,0.)=-A(0.,1.)*COSA
      DQ9(0.,1.,0.,0.)=1.
      DQA(0.,1.,0.,0.)=-A(0.,1.)*COSA
      DQB(0.,1.,0.,0.)=-A(0.,1.)*XDEFL*SINB
      DQC(0.,1.,0.,0.)=-A(0.,1.)*COSB
      DQD(0.,1.,0.,0.)=(-1.)
      DQE(0.,1.,0.,0.)=-A(0.,1.)*COSB
      DQ7(0.,1.,0.,1.)=0.
      DQ8(0.,1.,0.,1.)=0.
      DQ9(0.,1.,0.,1.)=0.
      DQA(0.,1.,0.,1.)=0.
      DQB(0.,1.,0.,1.)=0.
      DQC(0.,1.,0.,1.)=0.
      DQD(0.,1.,0.,1.)=0.
      DQE(0.,1.,0.,1.)=0.
      DQ7(0.,1.,0.,2.)=0.
      DQ8(0.,1.,0.,2.)=0.
      DQ9(0.,1.,0.,2.)=0.
      DQA(0.,1.,0.,2.)=0.
      DQB(0.,1.,0.,2.)=0.
      DQC(0.,1.,0.,2.)=0.
      DQD(0.,1.,0.,2.)=0.
      DQE(0.,1.,0.,2.)=0.
      DQ7(0.,1.,0.,3.)=0.
      DQ8(0.,1.,0.,3.)=0.
      DQ9(0.,1.,0.,3.)=0.
      DQA(0.,1.,0.,3.)=0.
      DQB(0.,1.,0.,3.)=0.
      DQC(0.,1.,0.,3.)=0.
      DQD(0.,1.,0.,3.)=0.
      DQE(0.,1.,0.,3.)=0.
      DQ7(0.,1.,1.,0.)=0.
      DQ8(0.,1.,1.,0.)=0.
      DQ9(0.,1.,1.,0.)=0.
      DQA(0.,1.,1.,0.)=0.
      DQB(0.,1.,1.,0.)=0.
      DQC(0.,1.,1.,0.)=0.
      DQD(0.,1.,1.,0.)=0.
      DQE(0.,1.,1.,0.)=0.
      DQ7(0.,1.,1.,1.)=0.
      DQ8(0.,1.,1.,1.)=0.
      DQ9(0.,1.,1.,1.)=0.
      DQA(0.,1.,1.,1.)=0.
      DQB(0.,1.,1.,1.)=0.
      DQC(0.,1.,1.,1.)=0.
      DQD(0.,1.,1.,1.)=0.
      DQE(0.,1.,1.,1.)=0.
      DQ7(0.,1.,1.,2.)=0.
      DQ8(0.,1.,1.,2.)=0.
      DQ9(0.,1.,1.,2.)=0.
      DQA(0.,1.,1.,2.)=0.
      DQB(0.,1.,1.,2.)=0.
      DQC(0.,1.,1.,2.)=0.
      DQD(0.,1.,1.,2.)=0.
      DQE(0.,1.,1.,2.)=0.
      DQ7(0.,1.,2.,0.)=0.
      DQ8(0.,1.,2.,0.)=0.
      DQ9(0.,1.,2.,0.)=0.
      DQA(0.,1.,2.,0.)=0.
      DQB(0.,1.,2.,0.)=0.
      DQC(0.,1.,2.,0.)=0.
      DQD(0.,1.,2.,0.)=0.
      DQE(0.,1.,2.,0.)=0.
      DQ7(0.,1.,2.,1.)=0.
      DQ8(0.,1.,2.,1.)=0.
      DQ9(0.,1.,2.,1.)=0.
      DQA(0.,1.,2.,1.)=0.
      DQB(0.,1.,2.,1.)=0.
      DQC(0.,1.,2.,1.)=0.
      DQD(0.,1.,2.,1.)=0.
      DQE(0.,1.,2.,1.)=0.
      DQ7(0.,1.,3.,0.)=0.
      DQ8(0.,1.,3.,0.)=0.
      DQ9(0.,1.,3.,0.)=0.
      DQA(0.,1.,3.,0.)=0.
      DQB(0.,1.,3.,0.)=0.
      DQC(0.,1.,3.,0.)=0.
      DQD(0.,1.,3.,0.)=0.
      DQE(0.,1.,3.,0.)=0.
      DQ7(0.,2.,0.,0.)=-2.*A(0.,2.)*XDEFL*SINA
      DQ8(0.,2.,0.,0.)=-2.*A(0.,2.)*COSA
      DQ9(0.,2.,0.,0.)=0.
      DQA(0.,2.,0.,0.)=-2.*A(0.,2.)*COSA
      DQB(0.,2.,0.,0.)=-2.*A(0.,2.)*XDEFL*SINB
      DQC(0.,2.,0.,0.)=-2.*A(0.,2.)*COSB
      DQD(0.,2.,0.,0.)=0.
      DQE(0.,2.,0.,0.)=-2.*A(0.,2.)*COSB
      DQ7(0.,2.,0.,1.)=0.
      DQ8(0.,2.,0.,1.)=0.
      DQ9(0.,2.,0.,1.)=0.
      DQA(0.,2.,0.,1.)=0.
      DQB(0.,2.,0.,1.)=0.
      DQC(0.,2.,0.,1.)=0.
      DQD(0.,2.,0.,1.)=0.
      DQE(0.,2.,0.,1.)=0.
      DQ7(0.,2.,0.,2.)=0.
      DQ8(0.,2.,0.,2.)=0.
      DQ9(0.,2.,0.,2.)=0.
      DQA(0.,2.,0.,2.)=0.
      DQB(0.,2.,0.,2.)=0.
      DQC(0.,2.,0.,2.)=0.
      DQD(0.,2.,0.,2.)=0.
      DQE(0.,2.,0.,2.)=0.
      DQ7(0.,2.,1.,0.)=0.
      DQ8(0.,2.,1.,0.)=0.
      DQ9(0.,2.,1.,0.)=0.
      DQA(0.,2.,1.,0.)=0.
      DQB(0.,2.,1.,0.)=0.
      DQC(0.,2.,1.,0.)=0.
      DQD(0.,2.,1.,0.)=0.
      DQE(0.,2.,1.,0.)=0.
      DQ7(0.,2.,1.,1.)=0.
      DQ8(0.,2.,1.,1.)=0.
      DQ9(0.,2.,1.,1.)=0.
      DQA(0.,2.,1.,1.)=0.
      DQB(0.,2.,1.,1.)=0.
      DQC(0.,2.,1.,1.)=0.
      DQD(0.,2.,1.,1.)=0.
      DQE(0.,2.,1.,1.)=0.
      DQ7(0.,2.,2.,0.)=0.
      DQ8(0.,2.,2.,0.)=0.
      DQ9(0.,2.,2.,0.)=0.
      DQA(0.,2.,2.,0.)=0.
      DQB(0.,2.,2.,0.)=0.
      DQC(0.,2.,2.,0.)=0.
      DQD(0.,2.,2.,0.)=0.
      DQE(0.,2.,2.,0.)=0.
      DQ7(0.,3.,0.,0.)=-6.*A(0.,3.)*XDEFL*SINA
      DQ8(0.,3.,0.,0.)=-6.*A(0.,3.)*COSA
      DQ9(0.,3.,0.,0.)=0.
      DQA(0.,3.,0.,0.)=-6.*A(0.,3.)*COSA
      DQB(0.,3.,0.,0.)=-6.*A(0.,3.)*XDEFL*SINB
      DQC(0.,3.,0.,0.)=-6.*A(0.,3.)*COSB
      DQD(0.,3.,0.,0.)=0.
      DQE(0.,3.,0.,0.)=-6.*A(0.,3.)*COSB
      DQ7(0.,3.,0.,1.)=0.
      DQ8(0.,3.,0.,1.)=0.
      DQ9(0.,3.,0.,1.)=0.
      DQA(0.,3.,0.,1.)=0.
      DQB(0.,3.,0.,1.)=0.
      DQC(0.,3.,0.,1.)=0.
      DQD(0.,3.,0.,1.)=0.
      DQE(0.,3.,0.,1.)=0.
      DQ7(0.,3.,1.,0.)=0.
      DQ8(0.,3.,1.,0.)=0.
      DQ9(0.,3.,1.,0.)=0.
      DQA(0.,3.,1.,0.)=0.
      DQB(0.,3.,1.,0.)=0.
      DQC(0.,3.,1.,0.)=0.
      DQD(0.,3.,1.,0.)=0.
      DQE(0.,3.,1.,0.)=0.
      DQ7(0.,4.,0.,0.)=-24.*A(0.,4.)*XDEFL*SINA
      DQ8(0.,4.,0.,0.)=-24.*A(0.,4.)*COSA
      DQ9(0.,4.,0.,0.)=0.
      DQA(0.,4.,0.,0.)=-24.*A(0.,4.)*COSA
      DQB(0.,4.,0.,0.)=-24.*A(0.,4.)*XDEFL*SINB
      DQC(0.,4.,0.,0.)=-24.*A(0.,4.)*COSB
      DQD(0.,4.,0.,0.)=0.
      DQE(0.,4.,0.,0.)=-24.*A(0.,4.)*COSB
      DQ7(1.,0.,0.,0.)=-A(1.,0.)*XDEFL*SINA+XDEFL*COSA
      DQ8(1.,0.,0.,0.)=-A(1.,0.)*COSA-SINA
      DQ9(1.,0.,0.,0.)=0.
      DQA(1.,0.,0.,0.)=-A(1.,0.)*COSA-SINA
      DQB(1.,0.,0.,0.)=-A(1.,0.)*XDEFL*SINB+XDEFL*COSB
      DQC(1.,0.,0.,0.)=-A(1.,0.)*COSB-SINB
      DQD(1.,0.,0.,0.)=0.
      DQE(1.,0.,0.,0.)=-A(1.,0.)*COSB-SINB
      DQ7(1.,0.,0.,1.)=0.
      DQ8(1.,0.,0.,1.)=0.
      DQ9(1.,0.,0.,1.)=0.
      DQA(1.,0.,0.,1.)=0.
      DQB(1.,0.,0.,1.)=0.
      DQC(1.,0.,0.,1.)=0.
      DQD(1.,0.,0.,1.)=0.
      DQE(1.,0.,0.,1.)=0.
      DQ7(1.,0.,0.,2.)=0.
      DQ8(1.,0.,0.,2.)=0.
      DQ9(1.,0.,0.,2.)=0.
      DQA(1.,0.,0.,2.)=0.
      DQB(1.,0.,0.,2.)=0.
      DQC(1.,0.,0.,2.)=0.
      DQD(1.,0.,0.,2.)=0.
      DQE(1.,0.,0.,2.)=0.
      DQ7(1.,0.,0.,3.)=0.
      DQ8(1.,0.,0.,3.)=0.
      DQ9(1.,0.,0.,3.)=0.
      DQA(1.,0.,0.,3.)=0.
      DQB(1.,0.,0.,3.)=0.
      DQC(1.,0.,0.,3.)=0.
      DQD(1.,0.,0.,3.)=0.
      DQE(1.,0.,0.,3.)=0.
      DQ7(1.,0.,1.,0.)=0.
      DQ8(1.,0.,1.,0.)=0.
      DQ9(1.,0.,1.,0.)=0.
      DQA(1.,0.,1.,0.)=0.
      DQB(1.,0.,1.,0.)=0.
      DQC(1.,0.,1.,0.)=0.
      DQD(1.,0.,1.,0.)=0.
      DQE(1.,0.,1.,0.)=0.
      DQ7(1.,0.,1.,1.)=0.
      DQ8(1.,0.,1.,1.)=0.
      DQ9(1.,0.,1.,1.)=0.
      DQA(1.,0.,1.,1.)=0.
      DQB(1.,0.,1.,1.)=0.
      DQC(1.,0.,1.,1.)=0.
      DQD(1.,0.,1.,1.)=0.
      DQE(1.,0.,1.,1.)=0.
      DQ7(1.,0.,1.,2.)=0.
      DQ8(1.,0.,1.,2.)=0.
      DQ9(1.,0.,1.,2.)=0.
      DQA(1.,0.,1.,2.)=0.
      DQB(1.,0.,1.,2.)=0.
      DQC(1.,0.,1.,2.)=0.
      DQD(1.,0.,1.,2.)=0.
      DQE(1.,0.,1.,2.)=0.
      DQ7(1.,0.,2.,0.)=0.
      DQ8(1.,0.,2.,0.)=0.
      DQ9(1.,0.,2.,0.)=0.
      DQA(1.,0.,2.,0.)=0.
      DQB(1.,0.,2.,0.)=0.
      DQC(1.,0.,2.,0.)=0.
      DQD(1.,0.,2.,0.)=0.
      DQE(1.,0.,2.,0.)=0.
      DQ7(1.,0.,2.,1.)=0.
      DQ8(1.,0.,2.,1.)=0.
      DQ9(1.,0.,2.,1.)=0.
      DQA(1.,0.,2.,1.)=0.
      DQB(1.,0.,2.,1.)=0.
      DQC(1.,0.,2.,1.)=0.
      DQD(1.,0.,2.,1.)=0.
      DQE(1.,0.,2.,1.)=0.
      DQ7(1.,0.,3.,0.)=0.
      DQ8(1.,0.,3.,0.)=0.
      DQ9(1.,0.,3.,0.)=0.
      DQA(1.,0.,3.,0.)=0.
      DQB(1.,0.,3.,0.)=0.
      DQC(1.,0.,3.,0.)=0.
      DQD(1.,0.,3.,0.)=0.
      DQE(1.,0.,3.,0.)=0.
      DQ7(1.,1.,0.,0.)=-A(1.,1.)*XDEFL*SINA
      DQ8(1.,1.,0.,0.)=-A(1.,1.)*COSA
      DQ9(1.,1.,0.,0.)=0.
      DQA(1.,1.,0.,0.)=-A(1.,1.)*COSA
      DQB(1.,1.,0.,0.)=-A(1.,1.)*XDEFL*SINB
      DQC(1.,1.,0.,0.)=-A(1.,1.)*COSB
      DQD(1.,1.,0.,0.)=0.
      DQE(1.,1.,0.,0.)=-A(1.,1.)*COSB
      DQ7(1.,1.,0.,1.)=0.
      DQ8(1.,1.,0.,1.)=0.
      DQ9(1.,1.,0.,1.)=0.
      DQA(1.,1.,0.,1.)=0.
      DQB(1.,1.,0.,1.)=0.
      DQC(1.,1.,0.,1.)=0.
      DQD(1.,1.,0.,1.)=0.
      DQE(1.,1.,0.,1.)=0.
      DQ7(1.,1.,0.,2.)=0.
      DQ8(1.,1.,0.,2.)=0.
      DQ9(1.,1.,0.,2.)=0.
      DQA(1.,1.,0.,2.)=0.
      DQB(1.,1.,0.,2.)=0.
      DQC(1.,1.,0.,2.)=0.
      DQD(1.,1.,0.,2.)=0.
      DQE(1.,1.,0.,2.)=0.
      DQ7(1.,1.,1.,0.)=0.
      DQ8(1.,1.,1.,0.)=0.
      DQ9(1.,1.,1.,0.)=0.
      DQA(1.,1.,1.,0.)=0.
      DQB(1.,1.,1.,0.)=0.
      DQC(1.,1.,1.,0.)=0.
      DQD(1.,1.,1.,0.)=0.
      DQE(1.,1.,1.,0.)=0.
      DQ7(1.,1.,1.,1.)=0.
      DQ8(1.,1.,1.,1.)=0.
      DQ9(1.,1.,1.,1.)=0.
      DQA(1.,1.,1.,1.)=0.
      DQB(1.,1.,1.,1.)=0.
      DQC(1.,1.,1.,1.)=0.
      DQD(1.,1.,1.,1.)=0.
      DQE(1.,1.,1.,1.)=0.
      DQ7(1.,1.,2.,0.)=0.
      DQ8(1.,1.,2.,0.)=0.
      DQ9(1.,1.,2.,0.)=0.
      DQA(1.,1.,2.,0.)=0.
      DQB(1.,1.,2.,0.)=0.
      DQC(1.,1.,2.,0.)=0.
      DQD(1.,1.,2.,0.)=0.
      DQE(1.,1.,2.,0.)=0.
      DQ7(1.,2.,0.,0.)=-2.*A(1.,2.)*XDEFL*SINA
      DQ8(1.,2.,0.,0.)=-2.*A(1.,2.)*COSA
      DQ9(1.,2.,0.,0.)=0.
      DQA(1.,2.,0.,0.)=-2.*A(1.,2.)*COSA
      DQB(1.,2.,0.,0.)=-2.*A(1.,2.)*XDEFL*SINB
      DQC(1.,2.,0.,0.)=-2.*A(1.,2.)*COSB
      DQD(1.,2.,0.,0.)=0.
      DQE(1.,2.,0.,0.)=-2.*A(1.,2.)*COSB
      DQ7(1.,2.,0.,1.)=0.
      DQ8(1.,2.,0.,1.)=0.
      DQ9(1.,2.,0.,1.)=0.
      DQA(1.,2.,0.,1.)=0.
      DQB(1.,2.,0.,1.)=0.
      DQC(1.,2.,0.,1.)=0.
      DQD(1.,2.,0.,1.)=0.
      DQE(1.,2.,0.,1.)=0.
      DQ7(1.,2.,1.,0.)=0.
      DQ8(1.,2.,1.,0.)=0.
      DQ9(1.,2.,1.,0.)=0.
      DQA(1.,2.,1.,0.)=0.
      DQB(1.,2.,1.,0.)=0.
      DQC(1.,2.,1.,0.)=0.
      DQD(1.,2.,1.,0.)=0.
      DQE(1.,2.,1.,0.)=0.
      DQ7(1.,3.,0.,0.)=-6.*A(1.,3.)*XDEFL*SINA
      DQ8(1.,3.,0.,0.)=-6.*A(1.,3.)*COSA
      DQ9(1.,3.,0.,0.)=0.
      DQA(1.,3.,0.,0.)=-6.*A(1.,3.)*COSA
      DQB(1.,3.,0.,0.)=-6.*A(1.,3.)*XDEFL*SINB
      DQC(1.,3.,0.,0.)=-6.*A(1.,3.)*COSB
      DQD(1.,3.,0.,0.)=0.
      DQE(1.,3.,0.,0.)=-6.*A(1.,3.)*COSB
      DQ7(2.,0.,0.,0.)=-2.*A(2.,0.)*XDEFL*SINA
      DQ8(2.,0.,0.,0.)=-2.*A(2.,0.)*COSA
      DQ9(2.,0.,0.,0.)=0.
      DQA(2.,0.,0.,0.)=-2.*A(2.,0.)*COSA
      DQB(2.,0.,0.,0.)=-2.*A(2.,0.)*XDEFL*SINB
      DQC(2.,0.,0.,0.)=-2.*A(2.,0.)*COSB
      DQD(2.,0.,0.,0.)=0.
      DQE(2.,0.,0.,0.)=-2.*A(2.,0.)*COSB
      DQ7(2.,0.,0.,1.)=0.
      DQ8(2.,0.,0.,1.)=0.
      DQ9(2.,0.,0.,1.)=0.
      DQA(2.,0.,0.,1.)=0.
      DQB(2.,0.,0.,1.)=0.
      DQC(2.,0.,0.,1.)=0.
      DQD(2.,0.,0.,1.)=0.
      DQE(2.,0.,0.,1.)=0.
      DQ7(2.,0.,0.,2.)=0.
      DQ8(2.,0.,0.,2.)=0.
      DQ9(2.,0.,0.,2.)=0.
      DQA(2.,0.,0.,2.)=0.
      DQB(2.,0.,0.,2.)=0.
      DQC(2.,0.,0.,2.)=0.
      DQD(2.,0.,0.,2.)=0.
      DQE(2.,0.,0.,2.)=0.
      DQ7(2.,0.,1.,0.)=0.
      DQ8(2.,0.,1.,0.)=0.
      DQ9(2.,0.,1.,0.)=0.
      DQA(2.,0.,1.,0.)=0.
      DQB(2.,0.,1.,0.)=0.
      DQC(2.,0.,1.,0.)=0.
      DQD(2.,0.,1.,0.)=0.
      DQE(2.,0.,1.,0.)=0.
      DQ7(2.,0.,1.,1.)=0.
      DQ8(2.,0.,1.,1.)=0.
      DQ9(2.,0.,1.,1.)=0.
      DQA(2.,0.,1.,1.)=0.
      DQB(2.,0.,1.,1.)=0.
      DQC(2.,0.,1.,1.)=0.
      DQD(2.,0.,1.,1.)=0.
      DQE(2.,0.,1.,1.)=0.
      DQ7(2.,0.,2.,0.)=0.
      DQ8(2.,0.,2.,0.)=0.
      DQ9(2.,0.,2.,0.)=0.
      DQA(2.,0.,2.,0.)=0.
      DQB(2.,0.,2.,0.)=0.
      DQC(2.,0.,2.,0.)=0.
      DQD(2.,0.,2.,0.)=0.
      DQE(2.,0.,2.,0.)=0.
      DQ7(2.,1.,0.,0.)=-2.*A(2.,1.)*XDEFL*SINA
      DQ8(2.,1.,0.,0.)=-2.*A(2.,1.)*COSA
      DQ9(2.,1.,0.,0.)=0.
      DQA(2.,1.,0.,0.)=-2.*A(2.,1.)*COSA
      DQB(2.,1.,0.,0.)=-2.*A(2.,1.)*XDEFL*SINB
      DQC(2.,1.,0.,0.)=-2.*A(2.,1.)*COSB
      DQD(2.,1.,0.,0.)=0.
      DQE(2.,1.,0.,0.)=-2.*A(2.,1.)*COSB
      DQ7(2.,1.,0.,1.)=0.
      DQ8(2.,1.,0.,1.)=0.
      DQ9(2.,1.,0.,1.)=0.
      DQA(2.,1.,0.,1.)=0.
      DQB(2.,1.,0.,1.)=0.
      DQC(2.,1.,0.,1.)=0.
      DQD(2.,1.,0.,1.)=0.
      DQE(2.,1.,0.,1.)=0.
      DQ7(2.,1.,1.,0.)=0.
      DQ8(2.,1.,1.,0.)=0.
      DQ9(2.,1.,1.,0.)=0.
      DQA(2.,1.,1.,0.)=0.
      DQB(2.,1.,1.,0.)=0.
      DQC(2.,1.,1.,0.)=0.
      DQD(2.,1.,1.,0.)=0.
      DQE(2.,1.,1.,0.)=0.
      DQ7(2.,2.,0.,0.)=-4.*A(2.,2.)*XDEFL*SINA
      DQ8(2.,2.,0.,0.)=-4.*A(2.,2.)*COSA
      DQ9(2.,2.,0.,0.)=0.
      DQA(2.,2.,0.,0.)=-4.*A(2.,2.)*COSA
      DQB(2.,2.,0.,0.)=-4.*A(2.,2.)*XDEFL*SINB
      DQC(2.,2.,0.,0.)=-4.*A(2.,2.)*COSB
      DQD(2.,2.,0.,0.)=0.
      DQE(2.,2.,0.,0.)=-4.*A(2.,2.)*COSB
      DQ7(3.,0.,0.,0.)=-6.*A(3.,0.)*XDEFL*SINA
      DQ8(3.,0.,0.,0.)=-6.*A(3.,0.)*COSA
      DQ9(3.,0.,0.,0.)=0.
      DQA(3.,0.,0.,0.)=-6.*A(3.,0.)*COSA
      DQB(3.,0.,0.,0.)=-6.*A(3.,0.)*XDEFL*SINB
      DQC(3.,0.,0.,0.)=-6.*A(3.,0.)*COSB
      DQD(3.,0.,0.,0.)=0.
      DQE(3.,0.,0.,0.)=-6.*A(3.,0.)*COSB
      DQ7(3.,0.,0.,1.)=0.
      DQ8(3.,0.,0.,1.)=0.
      DQ9(3.,0.,0.,1.)=0.
      DQA(3.,0.,0.,1.)=0.
      DQB(3.,0.,0.,1.)=0.
      DQC(3.,0.,0.,1.)=0.
      DQD(3.,0.,0.,1.)=0.
      DQE(3.,0.,0.,1.)=0.
      DQ7(3.,0.,1.,0.)=0.
      DQ8(3.,0.,1.,0.)=0.
      DQ9(3.,0.,1.,0.)=0.
      DQA(3.,0.,1.,0.)=0.
      DQB(3.,0.,1.,0.)=0.
      DQC(3.,0.,1.,0.)=0.
      DQD(3.,0.,1.,0.)=0.
      DQE(3.,0.,1.,0.)=0.
      DQ7(3.,1.,0.,0.)=-6.*A(3.,1.)*XDEFL*SINA
      DQ8(3.,1.,0.,0.)=-6.*A(3.,1.)*COSA
      DQ9(3.,1.,0.,0.)=0.
      DQA(3.,1.,0.,0.)=-6.*A(3.,1.)*COSA
      DQB(3.,1.,0.,0.)=-6.*A(3.,1.)*XDEFL*SINB
      DQC(3.,1.,0.,0.)=-6.*A(3.,1.)*COSB
      DQD(3.,1.,0.,0.)=0.
      DQE(3.,1.,0.,0.)=-6.*A(3.,1.)*COSB
      DQ7(4.,0.,0.,0.)=-24.*A(4.,0.)*XDEFL*SINA
      DQ8(4.,0.,0.,0.)=-24.*A(4.,0.)*COSA
      DQ9(4.,0.,0.,0.)=0.
      DQA(4.,0.,0.,0.)=-24.*A(4.,0.)*COSA
      DQB(4.,0.,0.,0.)=-24.*A(4.,0.)*XDEFL*SINB
      DQC(4.,0.,0.,0.)=-24.*A(4.,0.)*COSB
      DQD(4.,0.,0.,0.)=0.
      DQE(4.,0.,0.,0.)=-24.*A(4.,0.)*COSB
      return
      end
