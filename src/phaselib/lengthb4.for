C Datei: USERDISK_3:[FLECHSIG.PHAS.PHASEFOR.LIB]LENGTHB4.FOR
C Datum: 18.NOV.1996
C Stand: 18-NOV-1996
C Autor: FLECHSIG, BESSY Berlin
c ******************************************************************************
c
c   Copyright (C) 2014 Helmholtz-Zentrum Berlin, Germany and 
c                      Paul Scherrer Institut Villigen, Switzerland
c   
c   Author Johannes Bahrdt, johannes.bahrdt@helmholtz-berlin.de
c          Uwe Flechsig,    uwe.flechsig@psi.ch
c
c ------------------------------------------------------------------------------
c
c   This file is part of PHASE.
c
c   PHASE is free software: you can redistribute it and/or modify
c   it under the terms of the GNU General Public License as published by
c   the Free Software Foundation, version 3 of the License, or
c   (at your option) any later version.
c
c   PHASE is distributed in the hope that it will be useful,
c   but WITHOUT ANY WARRANTY; without even the implied warranty of
c   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
c   GNU General Public License for more details.
c
c   You should have received a copy of the GNU General Public License
c   along with PHASE (src/LICENSE).  If not, see <http://www.gnu.org/licenses/>. 
c
c ******************************************************************************

      subroutine lsubb(a,sina,cosa,sinb,cosb,r,rp,
     &                 idefl,dql1,dql2)
      implicit real*8(a-h,o-z)

      dimension a(0:5,0:5)
      dimension dql1(0:4,0:4,0:4,0:4,0:4,0:4),
     &          dql2(0:4,0:4,0:4,0:4,0:4,0:4)   

      xdefl=dflotj(idefl)
      dql1(0.0,0.0,0.0,0.0,0.0,0.0)=a(0.0,0.0)**2-2.0*a(0.0,0.0)*cosb
     . *rp+cosb**2*rp**2+rp**2*sinb**2
      dql2(0.0,0.0,0.0,0.0,0.0,0.0)=a(0.0,0.0)**2-2.0*a(0.0,0.0)*cosa
     . *r+cosa**2*r**2+r**2*sina**2
      dql1(0.0,0.0,0.0,0.0,0.0,1.0)=0.0
      dql2(0.0,0.0,0.0,0.0,0.0,1.0)=0.0
      dql1(0.0,0.0,0.0,0.0,0.0,2.0)=0.0
      dql2(0.0,0.0,0.0,0.0,0.0,2.0)=2.0
      dql1(0.0,0.0,0.0,0.0,0.0,3.0)=0.0
      dql2(0.0,0.0,0.0,0.0,0.0,3.0)=0.0
      dql1(0.0,0.0,0.0,0.0,0.0,4.0)=0.0
      dql2(0.0,0.0,0.0,0.0,0.0,4.0)=0.0
      dql1(0.0,0.0,0.0,0.0,1.0,0.0)=0.0
      dql2(0.0,0.0,0.0,0.0,1.0,0.0)=2.0*a(0.0,0.0)*sina*xdefl
      dql1(0.0,0.0,0.0,0.0,1.0,1.0)=0.0
      dql2(0.0,0.0,0.0,0.0,1.0,1.0)=0.0
      dql1(0.0,0.0,0.0,0.0,1.0,2.0)=0.0
      dql2(0.0,0.0,0.0,0.0,1.0,2.0)=0.0
      dql1(0.0,0.0,0.0,0.0,1.0,3.0)=0.0
      dql2(0.0,0.0,0.0,0.0,1.0,3.0)=0.0
      dql1(0.0,0.0,0.0,0.0,2.0,0.0)=0.0
      dql2(0.0,0.0,0.0,0.0,2.0,0.0)=2.0*cosa**2*xdefl**2+2.0*sina**2*
     . xdefl**2
      dql1(0.0,0.0,0.0,0.0,2.0,1.0)=0.0
      dql2(0.0,0.0,0.0,0.0,2.0,1.0)=0.0
      dql1(0.0,0.0,0.0,0.0,2.0,2.0)=0.0
      dql2(0.0,0.0,0.0,0.0,2.0,2.0)=0.0
      dql1(0.0,0.0,0.0,0.0,3.0,0.0)=0.0
      dql2(0.0,0.0,0.0,0.0,3.0,0.0)=0.0
      dql1(0.0,0.0,0.0,0.0,3.0,1.0)=0.0
      dql2(0.0,0.0,0.0,0.0,3.0,1.0)=0.0
      dql1(0.0,0.0,0.0,0.0,4.0,0.0)=0.0
      dql2(0.0,0.0,0.0,0.0,4.0,0.0)=0.0
      dql1(0.0,0.0,0.0,1.0,0.0,0.0)=0.0
      dql2(0.0,0.0,0.0,1.0,0.0,0.0)=0.0
      dql1(0.0,0.0,0.0,1.0,0.0,1.0)=0.0
      dql2(0.0,0.0,0.0,1.0,0.0,1.0)=0.0
      dql1(0.0,0.0,0.0,1.0,0.0,2.0)=0.0
      dql2(0.0,0.0,0.0,1.0,0.0,2.0)=0.0
      dql1(0.0,0.0,0.0,1.0,0.0,3.0)=0.0
      dql2(0.0,0.0,0.0,1.0,0.0,3.0)=0.0
      dql1(0.0,0.0,0.0,1.0,1.0,0.0)=0.0
      dql2(0.0,0.0,0.0,1.0,1.0,0.0)=0.0
      dql1(0.0,0.0,0.0,1.0,1.0,1.0)=0.0
      dql2(0.0,0.0,0.0,1.0,1.0,1.0)=0.0
      dql1(0.0,0.0,0.0,1.0,1.0,2.0)=0.0
      dql2(0.0,0.0,0.0,1.0,1.0,2.0)=0.0
      dql1(0.0,0.0,0.0,1.0,2.0,0.0)=0.0
      dql2(0.0,0.0,0.0,1.0,2.0,0.0)=0.0
      dql1(0.0,0.0,0.0,1.0,2.0,1.0)=0.0
      dql2(0.0,0.0,0.0,1.0,2.0,1.0)=0.0
      dql1(0.0,0.0,0.0,1.0,3.0,0.0)=0.0
      dql2(0.0,0.0,0.0,1.0,3.0,0.0)=0.0
      dql1(0.0,0.0,0.0,2.0,0.0,0.0)=2.0
      dql2(0.0,0.0,0.0,2.0,0.0,0.0)=0.0
      dql1(0.0,0.0,0.0,2.0,0.0,1.0)=0.0
      dql2(0.0,0.0,0.0,2.0,0.0,1.0)=0.0
      dql1(0.0,0.0,0.0,2.0,0.0,2.0)=0.0
      dql2(0.0,0.0,0.0,2.0,0.0,2.0)=0.0
      dql1(0.0,0.0,0.0,2.0,1.0,0.0)=0.0
      dql2(0.0,0.0,0.0,2.0,1.0,0.0)=0.0
      dql1(0.0,0.0,0.0,2.0,1.0,1.0)=0.0
      dql2(0.0,0.0,0.0,2.0,1.0,1.0)=0.0
      dql1(0.0,0.0,0.0,2.0,2.0,0.0)=0.0
      dql2(0.0,0.0,0.0,2.0,2.0,0.0)=0.0
      dql1(0.0,0.0,0.0,3.0,0.0,0.0)=0.0
      dql2(0.0,0.0,0.0,3.0,0.0,0.0)=0.0
      dql1(0.0,0.0,0.0,3.0,0.0,1.0)=0.0
      dql2(0.0,0.0,0.0,3.0,0.0,1.0)=0.0
      dql1(0.0,0.0,0.0,3.0,1.0,0.0)=0.0
      dql2(0.0,0.0,0.0,3.0,1.0,0.0)=0.0
      dql1(0.0,0.0,0.0,4.0,0.0,0.0)=0.0
      dql2(0.0,0.0,0.0,4.0,0.0,0.0)=0.0
      dql1(0.0,0.0,1.0,0.0,0.0,0.0)=-2.0*a(0.0,0.0)*sinb*xdefl
      dql2(0.0,0.0,1.0,0.0,0.0,0.0)=0.0
      dql1(0.0,0.0,1.0,0.0,0.0,1.0)=0.0
      dql2(0.0,0.0,1.0,0.0,0.0,1.0)=0.0
      dql1(0.0,0.0,1.0,0.0,0.0,2.0)=0.0
      dql2(0.0,0.0,1.0,0.0,0.0,2.0)=0.0
      dql1(0.0,0.0,1.0,0.0,0.0,3.0)=0.0
      dql2(0.0,0.0,1.0,0.0,0.0,3.0)=0.0
      dql1(0.0,0.0,1.0,0.0,1.0,0.0)=0.0
      dql2(0.0,0.0,1.0,0.0,1.0,0.0)=0.0
      dql1(0.0,0.0,1.0,0.0,1.0,1.0)=0.0
      dql2(0.0,0.0,1.0,0.0,1.0,1.0)=0.0
      dql1(0.0,0.0,1.0,0.0,1.0,2.0)=0.0
      dql2(0.0,0.0,1.0,0.0,1.0,2.0)=0.0
      dql1(0.0,0.0,1.0,0.0,2.0,0.0)=0.0
      dql2(0.0,0.0,1.0,0.0,2.0,0.0)=0.0
      dql1(0.0,0.0,1.0,0.0,2.0,1.0)=0.0
      dql2(0.0,0.0,1.0,0.0,2.0,1.0)=0.0
      dql1(0.0,0.0,1.0,0.0,3.0,0.0)=0.0
      dql2(0.0,0.0,1.0,0.0,3.0,0.0)=0.0
      dql1(0.0,0.0,1.0,1.0,0.0,0.0)=0.0
      dql2(0.0,0.0,1.0,1.0,0.0,0.0)=0.0
      dql1(0.0,0.0,1.0,1.0,0.0,1.0)=0.0
      dql2(0.0,0.0,1.0,1.0,0.0,1.0)=0.0
      dql1(0.0,0.0,1.0,1.0,0.0,2.0)=0.0
      dql2(0.0,0.0,1.0,1.0,0.0,2.0)=0.0
      dql1(0.0,0.0,1.0,1.0,1.0,0.0)=0.0
      dql2(0.0,0.0,1.0,1.0,1.0,0.0)=0.0
      dql1(0.0,0.0,1.0,1.0,1.0,1.0)=0.0
      dql2(0.0,0.0,1.0,1.0,1.0,1.0)=0.0
      dql1(0.0,0.0,1.0,1.0,2.0,0.0)=0.0
      dql2(0.0,0.0,1.0,1.0,2.0,0.0)=0.0
      dql1(0.0,0.0,1.0,2.0,0.0,0.0)=0.0
      dql2(0.0,0.0,1.0,2.0,0.0,0.0)=0.0
      dql1(0.0,0.0,1.0,2.0,0.0,1.0)=0.0
      dql2(0.0,0.0,1.0,2.0,0.0,1.0)=0.0
      dql1(0.0,0.0,1.0,2.0,1.0,0.0)=0.0
      dql2(0.0,0.0,1.0,2.0,1.0,0.0)=0.0
      dql1(0.0,0.0,1.0,3.0,0.0,0.0)=0.0
      dql2(0.0,0.0,1.0,3.0,0.0,0.0)=0.0
      dql1(0.0,0.0,2.0,0.0,0.0,0.0)=2.0*cosb**2*xdefl**2+2.0*sinb**2*
     . xdefl**2
      dql2(0.0,0.0,2.0,0.0,0.0,0.0)=0.0
      dql1(0.0,0.0,2.0,0.0,0.0,1.0)=0.0
      dql2(0.0,0.0,2.0,0.0,0.0,1.0)=0.0
      dql1(0.0,0.0,2.0,0.0,0.0,2.0)=0.0
      dql2(0.0,0.0,2.0,0.0,0.0,2.0)=0.0
      dql1(0.0,0.0,2.0,0.0,1.0,0.0)=0.0
      dql2(0.0,0.0,2.0,0.0,1.0,0.0)=0.0
      dql1(0.0,0.0,2.0,0.0,1.0,1.0)=0.0
      dql2(0.0,0.0,2.0,0.0,1.0,1.0)=0.0
      dql1(0.0,0.0,2.0,0.0,2.0,0.0)=0.0
      dql2(0.0,0.0,2.0,0.0,2.0,0.0)=0.0
      dql1(0.0,0.0,2.0,1.0,0.0,0.0)=0.0
      dql2(0.0,0.0,2.0,1.0,0.0,0.0)=0.0
      dql1(0.0,0.0,2.0,1.0,0.0,1.0)=0.0
      dql2(0.0,0.0,2.0,1.0,0.0,1.0)=0.0
      dql1(0.0,0.0,2.0,1.0,1.0,0.0)=0.0
      dql2(0.0,0.0,2.0,1.0,1.0,0.0)=0.0
      dql1(0.0,0.0,2.0,2.0,0.0,0.0)=0.0
      dql2(0.0,0.0,2.0,2.0,0.0,0.0)=0.0
      dql1(0.0,0.0,3.0,0.0,0.0,0.0)=0.0
      dql2(0.0,0.0,3.0,0.0,0.0,0.0)=0.0
      dql1(0.0,0.0,3.0,0.0,0.0,1.0)=0.0
      dql2(0.0,0.0,3.0,0.0,0.0,1.0)=0.0
      dql1(0.0,0.0,3.0,0.0,1.0,0.0)=0.0
      dql2(0.0,0.0,3.0,0.0,1.0,0.0)=0.0
      dql1(0.0,0.0,3.0,1.0,0.0,0.0)=0.0
      dql2(0.0,0.0,3.0,1.0,0.0,0.0)=0.0
      dql1(0.0,0.0,4.0,0.0,0.0,0.0)=0.0
      dql2(0.0,0.0,4.0,0.0,0.0,0.0)=0.0
      dql1(0.0,1.0,0.0,0.0,0.0,0.0)=2.0*a(0.0,1.0)*a(0.0,0.0)-2.0*a(
     . 0.0,1.0)*cosb*rp
      dql2(0.0,1.0,0.0,0.0,0.0,0.0)=2.0*a(0.0,1.0)*a(0.0,0.0)-2.0*a(
     . 0.0,1.0)*cosa*r
      dql1(0.0,1.0,0.0,0.0,0.0,1.0)=0.0
      dql2(0.0,1.0,0.0,0.0,0.0,1.0)=-2.0
      dql1(0.0,1.0,0.0,0.0,0.0,2.0)=0.0
      dql2(0.0,1.0,0.0,0.0,0.0,2.0)=0.0
      dql1(0.0,1.0,0.0,0.0,0.0,3.0)=0.0
      dql2(0.0,1.0,0.0,0.0,0.0,3.0)=0.0
      dql1(0.0,1.0,0.0,0.0,1.0,0.0)=0.0
      dql2(0.0,1.0,0.0,0.0,1.0,0.0)=2.0*a(0.0,1.0)*sina*xdefl
      dql1(0.0,1.0,0.0,0.0,1.0,1.0)=0.0
      dql2(0.0,1.0,0.0,0.0,1.0,1.0)=0.0
      dql1(0.0,1.0,0.0,0.0,1.0,2.0)=0.0
      dql2(0.0,1.0,0.0,0.0,1.0,2.0)=0.0
      dql1(0.0,1.0,0.0,0.0,2.0,0.0)=0.0
      dql2(0.0,1.0,0.0,0.0,2.0,0.0)=0.0
      dql1(0.0,1.0,0.0,0.0,2.0,1.0)=0.0
      dql2(0.0,1.0,0.0,0.0,2.0,1.0)=0.0
      dql1(0.0,1.0,0.0,0.0,3.0,0.0)=0.0
      dql2(0.0,1.0,0.0,0.0,3.0,0.0)=0.0
      dql1(0.0,1.0,0.0,1.0,0.0,0.0)=-2.0
      dql2(0.0,1.0,0.0,1.0,0.0,0.0)=0.0
      dql1(0.0,1.0,0.0,1.0,0.0,1.0)=0.0
      dql2(0.0,1.0,0.0,1.0,0.0,1.0)=0.0
      dql1(0.0,1.0,0.0,1.0,0.0,2.0)=0.0
      dql2(0.0,1.0,0.0,1.0,0.0,2.0)=0.0
      dql1(0.0,1.0,0.0,1.0,1.0,0.0)=0.0
      dql2(0.0,1.0,0.0,1.0,1.0,0.0)=0.0
      dql1(0.0,1.0,0.0,1.0,1.0,1.0)=0.0
      dql2(0.0,1.0,0.0,1.0,1.0,1.0)=0.0
      dql1(0.0,1.0,0.0,1.0,2.0,0.0)=0.0
      dql2(0.0,1.0,0.0,1.0,2.0,0.0)=0.0
      dql1(0.0,1.0,0.0,2.0,0.0,0.0)=0.0
      dql2(0.0,1.0,0.0,2.0,0.0,0.0)=0.0
      dql1(0.0,1.0,0.0,2.0,0.0,1.0)=0.0
      dql2(0.0,1.0,0.0,2.0,0.0,1.0)=0.0
      dql1(0.0,1.0,0.0,2.0,1.0,0.0)=0.0
      dql2(0.0,1.0,0.0,2.0,1.0,0.0)=0.0
      dql1(0.0,1.0,0.0,3.0,0.0,0.0)=0.0
      dql2(0.0,1.0,0.0,3.0,0.0,0.0)=0.0
      dql1(0.0,1.0,1.0,0.0,0.0,0.0)=-2.0*a(0.0,1.0)*sinb*xdefl
      dql2(0.0,1.0,1.0,0.0,0.0,0.0)=0.0
      dql1(0.0,1.0,1.0,0.0,0.0,1.0)=0.0
      dql2(0.0,1.0,1.0,0.0,0.0,1.0)=0.0
      dql1(0.0,1.0,1.0,0.0,0.0,2.0)=0.0
      dql2(0.0,1.0,1.0,0.0,0.0,2.0)=0.0
      dql1(0.0,1.0,1.0,0.0,1.0,0.0)=0.0
      dql2(0.0,1.0,1.0,0.0,1.0,0.0)=0.0
      dql1(0.0,1.0,1.0,0.0,1.0,1.0)=0.0
      dql2(0.0,1.0,1.0,0.0,1.0,1.0)=0.0
      dql1(0.0,1.0,1.0,0.0,2.0,0.0)=0.0
      dql2(0.0,1.0,1.0,0.0,2.0,0.0)=0.0
      dql1(0.0,1.0,1.0,1.0,0.0,0.0)=0.0
      dql2(0.0,1.0,1.0,1.0,0.0,0.0)=0.0
      dql1(0.0,1.0,1.0,1.0,0.0,1.0)=0.0
      dql2(0.0,1.0,1.0,1.0,0.0,1.0)=0.0
      dql1(0.0,1.0,1.0,1.0,1.0,0.0)=0.0
      dql2(0.0,1.0,1.0,1.0,1.0,0.0)=0.0
      dql1(0.0,1.0,1.0,2.0,0.0,0.0)=0.0
      dql2(0.0,1.0,1.0,2.0,0.0,0.0)=0.0
      dql1(0.0,1.0,2.0,0.0,0.0,0.0)=0.0
      dql2(0.0,1.0,2.0,0.0,0.0,0.0)=0.0
      dql1(0.0,1.0,2.0,0.0,0.0,1.0)=0.0
      dql2(0.0,1.0,2.0,0.0,0.0,1.0)=0.0
      dql1(0.0,1.0,2.0,0.0,1.0,0.0)=0.0
      dql2(0.0,1.0,2.0,0.0,1.0,0.0)=0.0
      dql1(0.0,1.0,2.0,1.0,0.0,0.0)=0.0
      dql2(0.0,1.0,2.0,1.0,0.0,0.0)=0.0
      dql1(0.0,1.0,3.0,0.0,0.0,0.0)=0.0
      dql2(0.0,1.0,3.0,0.0,0.0,0.0)=0.0
      dql1(0.0,2.0,0.0,0.0,0.0,0.0)=4.0*a(0.0,2.0)*a(0.0,0.0)-4.0*a(
     . 0.0,2.0)*cosb*rp+2.0*a(0.0,1.0)**2+2.0
      dql2(0.0,2.0,0.0,0.0,0.0,0.0)=4.0*a(0.0,2.0)*a(0.0,0.0)-4.0*a(
     . 0.0,2.0)*cosa*r+2.0*a(0.0,1.0)**2+2.0
      dql1(0.0,2.0,0.0,0.0,0.0,1.0)=0.0
      dql2(0.0,2.0,0.0,0.0,0.0,1.0)=0.0
      dql1(0.0,2.0,0.0,0.0,0.0,2.0)=0.0
      dql2(0.0,2.0,0.0,0.0,0.0,2.0)=0.0
      dql1(0.0,2.0,0.0,0.0,1.0,0.0)=0.0
      dql2(0.0,2.0,0.0,0.0,1.0,0.0)=4.0*a(0.0,2.0)*sina*xdefl
      dql1(0.0,2.0,0.0,0.0,1.0,1.0)=0.0
      dql2(0.0,2.0,0.0,0.0,1.0,1.0)=0.0
      dql1(0.0,2.0,0.0,0.0,2.0,0.0)=0.0
      dql2(0.0,2.0,0.0,0.0,2.0,0.0)=0.0
      dql1(0.0,2.0,0.0,1.0,0.0,0.0)=0.0
      dql2(0.0,2.0,0.0,1.0,0.0,0.0)=0.0
      dql1(0.0,2.0,0.0,1.0,0.0,1.0)=0.0
      dql2(0.0,2.0,0.0,1.0,0.0,1.0)=0.0
      dql1(0.0,2.0,0.0,1.0,1.0,0.0)=0.0
      dql2(0.0,2.0,0.0,1.0,1.0,0.0)=0.0
      dql1(0.0,2.0,0.0,2.0,0.0,0.0)=0.0
      dql2(0.0,2.0,0.0,2.0,0.0,0.0)=0.0
      dql1(0.0,2.0,1.0,0.0,0.0,0.0)=-4.0*a(0.0,2.0)*sinb*xdefl
      dql2(0.0,2.0,1.0,0.0,0.0,0.0)=0.0
      dql1(0.0,2.0,1.0,0.0,0.0,1.0)=0.0
      dql2(0.0,2.0,1.0,0.0,0.0,1.0)=0.0
      dql1(0.0,2.0,1.0,0.0,1.0,0.0)=0.0
      dql2(0.0,2.0,1.0,0.0,1.0,0.0)=0.0
      dql1(0.0,2.0,1.0,1.0,0.0,0.0)=0.0
      dql2(0.0,2.0,1.0,1.0,0.0,0.0)=0.0
      dql1(0.0,2.0,2.0,0.0,0.0,0.0)=0.0
      dql2(0.0,2.0,2.0,0.0,0.0,0.0)=0.0
      dql1(0.0,3.0,0.0,0.0,0.0,0.0)=12.0*a(0.0,3.0)*a(0.0,0.0)-12.0*a
     . (0.0,3.0)*cosb*rp+12.0*a(0.0,2.0)*a(0.0,1.0)
      dql2(0.0,3.0,0.0,0.0,0.0,0.0)=12.0*a(0.0,3.0)*a(0.0,0.0)-12.0*a
     . (0.0,3.0)*cosa*r+12.0*a(0.0,2.0)*a(0.0,1.0)
      dql1(0.0,3.0,0.0,0.0,0.0,1.0)=0.0
      dql2(0.0,3.0,0.0,0.0,0.0,1.0)=0.0
      dql1(0.0,3.0,0.0,0.0,1.0,0.0)=0.0
      dql2(0.0,3.0,0.0,0.0,1.0,0.0)=12.0*a(0.0,3.0)*sina*xdefl
      dql1(0.0,3.0,0.0,1.0,0.0,0.0)=0.0
      dql2(0.0,3.0,0.0,1.0,0.0,0.0)=0.0
      dql1(0.0,3.0,1.0,0.0,0.0,0.0)=-12.0*a(0.0,3.0)*sinb*xdefl
      dql2(0.0,3.0,1.0,0.0,0.0,0.0)=0.0
      dql1(0.0,4.0,0.0,0.0,0.0,0.0)=48.0*a(0.0,4.0)*a(0.0,0.0)-48.0*a
     . (0.0,4.0)*cosb*rp+48.0*a(0.0,3.0)*a(0.0,1.0)+24.0*a(0.0,2.0)**
     . 2
      dql2(0.0,4.0,0.0,0.0,0.0,0.0)=48.0*a(0.0,4.0)*a(0.0,0.0)-48.0*a
     . (0.0,4.0)*cosa*r+48.0*a(0.0,3.0)*a(0.0,1.0)+24.0*a(0.0,2.0)**2
      dql1(1.0,0.0,0.0,0.0,0.0,0.0)=2.0*a(1.0,0.0)*a(0.0,0.0)-2.0*a(
     . 1.0,0.0)*cosb*rp-2.0*rp*sinb
      dql2(1.0,0.0,0.0,0.0,0.0,0.0)=2.0*a(1.0,0.0)*a(0.0,0.0)-2.0*a(
     . 1.0,0.0)*cosa*r-2.0*r*sina
      dql1(1.0,0.0,0.0,0.0,0.0,1.0)=0.0
      dql2(1.0,0.0,0.0,0.0,0.0,1.0)=0.0
      dql1(1.0,0.0,0.0,0.0,0.0,2.0)=0.0
      dql2(1.0,0.0,0.0,0.0,0.0,2.0)=0.0
      dql1(1.0,0.0,0.0,0.0,0.0,3.0)=0.0
      dql2(1.0,0.0,0.0,0.0,0.0,3.0)=0.0
      dql1(1.0,0.0,0.0,0.0,1.0,0.0)=0.0
      dql2(1.0,0.0,0.0,0.0,1.0,0.0)=2.0*a(1.0,0.0)*sina*xdefl-2.0*
     . cosa*xdefl
      dql1(1.0,0.0,0.0,0.0,1.0,1.0)=0.0
      dql2(1.0,0.0,0.0,0.0,1.0,1.0)=0.0
      dql1(1.0,0.0,0.0,0.0,1.0,2.0)=0.0
      dql2(1.0,0.0,0.0,0.0,1.0,2.0)=0.0
      dql1(1.0,0.0,0.0,0.0,2.0,0.0)=0.0
      dql2(1.0,0.0,0.0,0.0,2.0,0.0)=0.0
      dql1(1.0,0.0,0.0,0.0,2.0,1.0)=0.0
      dql2(1.0,0.0,0.0,0.0,2.0,1.0)=0.0
      dql1(1.0,0.0,0.0,0.0,3.0,0.0)=0.0
      dql2(1.0,0.0,0.0,0.0,3.0,0.0)=0.0
      dql1(1.0,0.0,0.0,1.0,0.0,0.0)=0.0
      dql2(1.0,0.0,0.0,1.0,0.0,0.0)=0.0
      dql1(1.0,0.0,0.0,1.0,0.0,1.0)=0.0
      dql2(1.0,0.0,0.0,1.0,0.0,1.0)=0.0
      dql1(1.0,0.0,0.0,1.0,0.0,2.0)=0.0
      dql2(1.0,0.0,0.0,1.0,0.0,2.0)=0.0
      dql1(1.0,0.0,0.0,1.0,1.0,0.0)=0.0
      dql2(1.0,0.0,0.0,1.0,1.0,0.0)=0.0
      dql1(1.0,0.0,0.0,1.0,1.0,1.0)=0.0
      dql2(1.0,0.0,0.0,1.0,1.0,1.0)=0.0
      dql1(1.0,0.0,0.0,1.0,2.0,0.0)=0.0
      dql2(1.0,0.0,0.0,1.0,2.0,0.0)=0.0
      dql1(1.0,0.0,0.0,2.0,0.0,0.0)=0.0
      dql2(1.0,0.0,0.0,2.0,0.0,0.0)=0.0
      dql1(1.0,0.0,0.0,2.0,0.0,1.0)=0.0
      dql2(1.0,0.0,0.0,2.0,0.0,1.0)=0.0
      dql1(1.0,0.0,0.0,2.0,1.0,0.0)=0.0
      dql2(1.0,0.0,0.0,2.0,1.0,0.0)=0.0
      dql1(1.0,0.0,0.0,3.0,0.0,0.0)=0.0
      dql2(1.0,0.0,0.0,3.0,0.0,0.0)=0.0
      dql1(1.0,0.0,1.0,0.0,0.0,0.0)=-2.0*a(1.0,0.0)*sinb*xdefl+2.0*
     . cosb*xdefl
      dql2(1.0,0.0,1.0,0.0,0.0,0.0)=0.0
      dql1(1.0,0.0,1.0,0.0,0.0,1.0)=0.0
      dql2(1.0,0.0,1.0,0.0,0.0,1.0)=0.0
      dql1(1.0,0.0,1.0,0.0,0.0,2.0)=0.0
      dql2(1.0,0.0,1.0,0.0,0.0,2.0)=0.0
      dql1(1.0,0.0,1.0,0.0,1.0,0.0)=0.0
      dql2(1.0,0.0,1.0,0.0,1.0,0.0)=0.0
      dql1(1.0,0.0,1.0,0.0,1.0,1.0)=0.0
      dql2(1.0,0.0,1.0,0.0,1.0,1.0)=0.0
      dql1(1.0,0.0,1.0,0.0,2.0,0.0)=0.0
      dql2(1.0,0.0,1.0,0.0,2.0,0.0)=0.0
      dql1(1.0,0.0,1.0,1.0,0.0,0.0)=0.0
      dql2(1.0,0.0,1.0,1.0,0.0,0.0)=0.0
      dql1(1.0,0.0,1.0,1.0,0.0,1.0)=0.0
      dql2(1.0,0.0,1.0,1.0,0.0,1.0)=0.0
      dql1(1.0,0.0,1.0,1.0,1.0,0.0)=0.0
      dql2(1.0,0.0,1.0,1.0,1.0,0.0)=0.0
      dql1(1.0,0.0,1.0,2.0,0.0,0.0)=0.0
      dql2(1.0,0.0,1.0,2.0,0.0,0.0)=0.0
      dql1(1.0,0.0,2.0,0.0,0.0,0.0)=0.0
      dql2(1.0,0.0,2.0,0.0,0.0,0.0)=0.0
      dql1(1.0,0.0,2.0,0.0,0.0,1.0)=0.0
      dql2(1.0,0.0,2.0,0.0,0.0,1.0)=0.0
      dql1(1.0,0.0,2.0,0.0,1.0,0.0)=0.0
      dql2(1.0,0.0,2.0,0.0,1.0,0.0)=0.0
      dql1(1.0,0.0,2.0,1.0,0.0,0.0)=0.0
      dql2(1.0,0.0,2.0,1.0,0.0,0.0)=0.0
      dql1(1.0,0.0,3.0,0.0,0.0,0.0)=0.0
      dql2(1.0,0.0,3.0,0.0,0.0,0.0)=0.0
      dql1(1.0,1.0,0.0,0.0,0.0,0.0)=2.0*a(1.0,1.0)*a(0.0,0.0)-2.0*a(
     . 1.0,1.0)*cosb*rp+2.0*a(1.0,0.0)*a(0.0,1.0)
      dql2(1.0,1.0,0.0,0.0,0.0,0.0)=2.0*a(1.0,1.0)*a(0.0,0.0)-2.0*a(
     . 1.0,1.0)*cosa*r+2.0*a(1.0,0.0)*a(0.0,1.0)
      dql1(1.0,1.0,0.0,0.0,0.0,1.0)=0.0
      dql2(1.0,1.0,0.0,0.0,0.0,1.0)=0.0
      dql1(1.0,1.0,0.0,0.0,0.0,2.0)=0.0
      dql2(1.0,1.0,0.0,0.0,0.0,2.0)=0.0
      dql1(1.0,1.0,0.0,0.0,1.0,0.0)=0.0
      dql2(1.0,1.0,0.0,0.0,1.0,0.0)=2.0*a(1.0,1.0)*sina*xdefl
      dql1(1.0,1.0,0.0,0.0,1.0,1.0)=0.0
      dql2(1.0,1.0,0.0,0.0,1.0,1.0)=0.0
      dql1(1.0,1.0,0.0,0.0,2.0,0.0)=0.0
      dql2(1.0,1.0,0.0,0.0,2.0,0.0)=0.0
      dql1(1.0,1.0,0.0,1.0,0.0,0.0)=0.0
      dql2(1.0,1.0,0.0,1.0,0.0,0.0)=0.0
      dql1(1.0,1.0,0.0,1.0,0.0,1.0)=0.0
      dql2(1.0,1.0,0.0,1.0,0.0,1.0)=0.0
      dql1(1.0,1.0,0.0,1.0,1.0,0.0)=0.0
      dql2(1.0,1.0,0.0,1.0,1.0,0.0)=0.0
      dql1(1.0,1.0,0.0,2.0,0.0,0.0)=0.0
      dql2(1.0,1.0,0.0,2.0,0.0,0.0)=0.0
      dql1(1.0,1.0,1.0,0.0,0.0,0.0)=-2.0*a(1.0,1.0)*sinb*xdefl
      dql2(1.0,1.0,1.0,0.0,0.0,0.0)=0.0
      dql1(1.0,1.0,1.0,0.0,0.0,1.0)=0.0
      dql2(1.0,1.0,1.0,0.0,0.0,1.0)=0.0
      dql1(1.0,1.0,1.0,0.0,1.0,0.0)=0.0
      dql2(1.0,1.0,1.0,0.0,1.0,0.0)=0.0
      dql1(1.0,1.0,1.0,1.0,0.0,0.0)=0.0
      dql2(1.0,1.0,1.0,1.0,0.0,0.0)=0.0
      dql1(1.0,1.0,2.0,0.0,0.0,0.0)=0.0
      dql2(1.0,1.0,2.0,0.0,0.0,0.0)=0.0
      dql1(1.0,2.0,0.0,0.0,0.0,0.0)=4.0*a(1.0,2.0)*a(0.0,0.0)-4.0*a(
     . 1.0,2.0)*cosb*rp+4.0*a(1.0,1.0)*a(0.0,1.0)+4.0*a(1.0,0.0)*a(
     . 0.0,2.0)
      dql2(1.0,2.0,0.0,0.0,0.0,0.0)=4.0*a(1.0,2.0)*a(0.0,0.0)-4.0*a(
     . 1.0,2.0)*cosa*r+4.0*a(1.0,1.0)*a(0.0,1.0)+4.0*a(1.0,0.0)*a(0.0
     . ,2.0)
      dql1(1.0,2.0,0.0,0.0,0.0,1.0)=0.0
      dql2(1.0,2.0,0.0,0.0,0.0,1.0)=0.0
      dql1(1.0,2.0,0.0,0.0,1.0,0.0)=0.0
      dql2(1.0,2.0,0.0,0.0,1.0,0.0)=4.0*a(1.0,2.0)*sina*xdefl
      dql1(1.0,2.0,0.0,1.0,0.0,0.0)=0.0
      dql2(1.0,2.0,0.0,1.0,0.0,0.0)=0.0
      dql1(1.0,2.0,1.0,0.0,0.0,0.0)=-4.0*a(1.0,2.0)*sinb*xdefl
      dql2(1.0,2.0,1.0,0.0,0.0,0.0)=0.0
      dql1(1.0,3.0,0.0,0.0,0.0,0.0)=12.0*a(1.0,3.0)*a(0.0,0.0)-12.0*a
     . (1.0,3.0)*cosb*rp+12.0*a(1.0,2.0)*a(0.0,1.0)+12.0*a(1.0,1.0)*a
     . (0.0,2.0)+12.0*a(1.0,0.0)*a(0.0,3.0)
      dql2(1.0,3.0,0.0,0.0,0.0,0.0)=12.0*a(1.0,3.0)*a(0.0,0.0)-12.0*a
     . (1.0,3.0)*cosa*r+12.0*a(1.0,2.0)*a(0.0,1.0)+12.0*a(1.0,1.0)*a(
     . 0.0,2.0)+12.0*a(1.0,0.0)*a(0.0,3.0)
      dql1(2.0,0.0,0.0,0.0,0.0,0.0)=4.0*a(2.0,0.0)*a(0.0,0.0)-4.0*a(
     . 2.0,0.0)*cosb*rp+2.0*a(1.0,0.0)**2+2.0
      dql2(2.0,0.0,0.0,0.0,0.0,0.0)=4.0*a(2.0,0.0)*a(0.0,0.0)-4.0*a(
     . 2.0,0.0)*cosa*r+2.0*a(1.0,0.0)**2+2.0
      dql1(2.0,0.0,0.0,0.0,0.0,1.0)=0.0
      dql2(2.0,0.0,0.0,0.0,0.0,1.0)=0.0
      dql1(2.0,0.0,0.0,0.0,0.0,2.0)=0.0
      dql2(2.0,0.0,0.0,0.0,0.0,2.0)=0.0
      dql1(2.0,0.0,0.0,0.0,1.0,0.0)=0.0
      dql2(2.0,0.0,0.0,0.0,1.0,0.0)=4.0*a(2.0,0.0)*sina*xdefl
      dql1(2.0,0.0,0.0,0.0,1.0,1.0)=0.0
      dql2(2.0,0.0,0.0,0.0,1.0,1.0)=0.0
      dql1(2.0,0.0,0.0,0.0,2.0,0.0)=0.0
      dql2(2.0,0.0,0.0,0.0,2.0,0.0)=0.0
      dql1(2.0,0.0,0.0,1.0,0.0,0.0)=0.0
      dql2(2.0,0.0,0.0,1.0,0.0,0.0)=0.0
      dql1(2.0,0.0,0.0,1.0,0.0,1.0)=0.0
      dql2(2.0,0.0,0.0,1.0,0.0,1.0)=0.0
      dql1(2.0,0.0,0.0,1.0,1.0,0.0)=0.0
      dql2(2.0,0.0,0.0,1.0,1.0,0.0)=0.0
      dql1(2.0,0.0,0.0,2.0,0.0,0.0)=0.0
      dql2(2.0,0.0,0.0,2.0,0.0,0.0)=0.0
      dql1(2.0,0.0,1.0,0.0,0.0,0.0)=-4.0*a(2.0,0.0)*sinb*xdefl
      dql2(2.0,0.0,1.0,0.0,0.0,0.0)=0.0
      dql1(2.0,0.0,1.0,0.0,0.0,1.0)=0.0
      dql2(2.0,0.0,1.0,0.0,0.0,1.0)=0.0
      dql1(2.0,0.0,1.0,0.0,1.0,0.0)=0.0
      dql2(2.0,0.0,1.0,0.0,1.0,0.0)=0.0
      dql1(2.0,0.0,1.0,1.0,0.0,0.0)=0.0
      dql2(2.0,0.0,1.0,1.0,0.0,0.0)=0.0
      dql1(2.0,0.0,2.0,0.0,0.0,0.0)=0.0
      dql2(2.0,0.0,2.0,0.0,0.0,0.0)=0.0
      dql1(2.0,1.0,0.0,0.0,0.0,0.0)=4.0*a(2.0,1.0)*a(0.0,0.0)-4.0*a(
     . 2.0,1.0)*cosb*rp+4.0*a(2.0,0.0)*a(0.0,1.0)+4.0*a(1.0,1.0)*a(
     . 1.0,0.0)
      dql2(2.0,1.0,0.0,0.0,0.0,0.0)=4.0*a(2.0,1.0)*a(0.0,0.0)-4.0*a(
     . 2.0,1.0)*cosa*r+4.0*a(2.0,0.0)*a(0.0,1.0)+4.0*a(1.0,1.0)*a(1.0
     . ,0.0)
      dql1(2.0,1.0,0.0,0.0,0.0,1.0)=0.0
      dql2(2.0,1.0,0.0,0.0,0.0,1.0)=0.0
      dql1(2.0,1.0,0.0,0.0,1.0,0.0)=0.0
      dql2(2.0,1.0,0.0,0.0,1.0,0.0)=4.0*a(2.0,1.0)*sina*xdefl
      dql1(2.0,1.0,0.0,1.0,0.0,0.0)=0.0
      dql2(2.0,1.0,0.0,1.0,0.0,0.0)=0.0
      dql1(2.0,1.0,1.0,0.0,0.0,0.0)=-4.0*a(2.0,1.0)*sinb*xdefl
      dql2(2.0,1.0,1.0,0.0,0.0,0.0)=0.0
      dql1(2.0,2.0,0.0,0.0,0.0,0.0)=8.0*a(2.0,2.0)*a(0.0,0.0)-8.0*a(
     . 2.0,2.0)*cosb*rp+8.0*a(2.0,1.0)*a(0.0,1.0)+8.0*a(2.0,0.0)*a(
     . 0.0,2.0)+8.0*a(1.0,2.0)*a(1.0,0.0)+4.0*a(1.0,1.0)**2
      dql2(2.0,2.0,0.0,0.0,0.0,0.0)=8.0*a(2.0,2.0)*a(0.0,0.0)-8.0*a(
     . 2.0,2.0)*cosa*r+8.0*a(2.0,1.0)*a(0.0,1.0)+8.0*a(2.0,0.0)*a(0.0
     . ,2.0)+8.0*a(1.0,2.0)*a(1.0,0.0)+4.0*a(1.0,1.0)**2
      dql1(3.0,0.0,0.0,0.0,0.0,0.0)=12.0*a(3.0,0.0)*a(0.0,0.0)-12.0*a
     . (3.0,0.0)*cosb*rp+12.0*a(2.0,0.0)*a(1.0,0.0)
      dql2(3.0,0.0,0.0,0.0,0.0,0.0)=12.0*a(3.0,0.0)*a(0.0,0.0)-12.0*a
     . (3.0,0.0)*cosa*r+12.0*a(2.0,0.0)*a(1.0,0.0)
      dql1(3.0,0.0,0.0,0.0,0.0,1.0)=0.0
      dql2(3.0,0.0,0.0,0.0,0.0,1.0)=0.0
      dql1(3.0,0.0,0.0,0.0,1.0,0.0)=0.0
      dql2(3.0,0.0,0.0,0.0,1.0,0.0)=12.0*a(3.0,0.0)*sina*xdefl
      dql1(3.0,0.0,0.0,1.0,0.0,0.0)=0.0
      dql2(3.0,0.0,0.0,1.0,0.0,0.0)=0.0
      dql1(3.0,0.0,1.0,0.0,0.0,0.0)=-12.0*a(3.0,0.0)*sinb*xdefl
      dql2(3.0,0.0,1.0,0.0,0.0,0.0)=0.0
      dql1(3.0,1.0,0.0,0.0,0.0,0.0)=12.0*a(3.0,1.0)*a(0.0,0.0)-12.0*a
     . (3.0,1.0)*cosb*rp+12.0*a(3.0,0.0)*a(0.0,1.0)+12.0*a(2.0,1.0)*a
     . (1.0,0.0)+12.0*a(2.0,0.0)*a(1.0,1.0)
      dql2(3.0,1.0,0.0,0.0,0.0,0.0)=12.0*a(3.0,1.0)*a(0.0,0.0)-12.0*a
     . (3.0,1.0)*cosa*r+12.0*a(3.0,0.0)*a(0.0,1.0)+12.0*a(2.0,1.0)*a(
     . 1.0,0.0)+12.0*a(2.0,0.0)*a(1.0,1.0)
      dql1(4.0,0.0,0.0,0.0,0.0,0.0)=48.0*a(4.0,0.0)*a(0.0,0.0)-48.0*a
     . (4.0,0.0)*cosb*rp+48.0*a(3.0,0.0)*a(1.0,0.0)+24.0*a(2.0,0.0)**
     . 2
      dql2(4.0,0.0,0.0,0.0,0.0,0.0)=48.0*a(4.0,0.0)*a(0.0,0.0)-48.0*a
     . (4.0,0.0)*cosa*r+48.0*a(3.0,0.0)*a(1.0,0.0)+24.0*a(2.0,0.0)**2
      return
      end
